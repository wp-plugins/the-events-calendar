jQuery(document).ready(function(a){function g(){a("a#ticket_form_toggle").show();a("#ticket_form input:not(:button):not(:radio):not(:checkbox)").val("");a("#ticket_form input:checkbox").attr("checked",!1);a("#ticket_form textarea").val("");a("#ticket_form").hide()}function h(){jQuery("#event_tickets").css("opacity","0.5");jQuery("#tribe-loading").show()}function k(){jQuery("#event_tickets").css("opacity","1");jQuery("#tribe-loading").hide()}var f={dateFormat:"yy-mm-dd",showAnim:"fadeIn",changeMonth:!0,
changeYear:!0,numberOfMonths:3,showButtonPanel:!0,onChange:function(){alert("lala")},onSelect:function(b,d){var c=a.datepicker.parseDate("yy-mm-dd",b);"ticket_start_date"===d.id?a("#ticket_end_date").datepicker("option","minDate",c):a("#ticket_start_date").datepicker("option","maxDate",c)}};a("#ticket_start_date").datepicker(f).keyup(function(b){(8==b.keyCode||46==b.keyCode)&&a.datepicker._clearDate(this)});a("#ticket_end_date").datepicker(f).keyup(function(b){(8==b.keyCode||46==b.keyCode)&&a.datepicker._clearDate(this)});
a("input[name=ticket_provider]:radio").change(function(){a("tr.ticket_advanced").hide();a("tr.ticket_advanced_"+this.value).show()});a("input[name=ticket_provider]:checked").each(function(){a("tr.ticket_advanced").hide();a("tr.ticket_advanced_"+this.value).show()});a("a#ticket_form_toggle").click(function(b){a("h4.ticket_form_title_edit").hide();a("h4.ticket_form_title_add").show();a(this).hide();g();a("#ticket_form").show();a("html, body").animate({scrollTop:a("#ticket_form_table").offset().top-
50},500);b.preventDefault()});a("#ticket_form_cancel").click(function(){g();a("html, body").animate({scrollTop:a("#event_tickets").offset().top-50},500)});a("#ticket_form_save").click(function(){h();var b={action:"tribe-ticket-add-"+a("input[name=ticket_provider]:checked").val(),formdata:a(".ticket_field").serialize(),post_ID:a("#post_ID").val(),nonce:TribeTickets.add_ticket_nonce};a.post(ajaxurl,b,function(b){b.success&&(g(),a("td.ticket_list_container").empty().html(b.data))},"json").complete(function(){a("html, body").animate({scrollTop:a("#event_tickets").offset().top-
50},500);k()})});a("#tribetickets").on("click",".ticket_delete",function(b){b.preventDefault();h();b={action:"tribe-ticket-delete-"+a(this).attr("attr-provider"),post_ID:a("#post_ID").val(),ticket_id:a(this).attr("attr-ticket-id"),nonce:TribeTickets.remove_ticket_nonce};a.post(ajaxurl,b,function(b){b.success&&(g(),a("td.ticket_list_container").empty().html(b.data))},"json").complete(function(){k()})});a("#tribetickets").on("click",".ticket_edit",function(b){b.preventDefault();a("h4.ticket_form_title_edit").show();
a("h4.ticket_form_title_add").hide();h();b={action:"tribe-ticket-edit-"+a(this).attr("attr-provider"),post_ID:a("#post_ID").val(),ticket_id:a(this).attr("attr-ticket-id"),nonce:TribeTickets.edit_ticket_nonce};a.post(ajaxurl,b,function(b){g();a("#ticket_id").val(b.data.ID);a("#ticket_name").val(b.data.name);a("#ticket_description").val(b.data.description);a("#ticket_price").val(b.data.price);a("#ticket_start_date").val(b.data.start_date.substring(0,10));a("#ticket_end_date").val(b.data.end_date.substring(0,
10));if(b.data.start_date){var c=b.data.start_date.substring(11,13),e="am";12<parseInt(c)&&(e="pm",c=parseInt(c)-12,c=("0"+c).slice(-2));12===parseInt(c)&&(e="pm");a("#ticket_start_hour").val(c);a("#ticket_start_meridian").val(e)}b.data.end_date&&(c=b.data.end_date.substring(11,13),e="am",12<parseInt(c)&&(e="pm",c=parseInt(c)-12,c=("0"+c).slice(-2)),12===parseInt(c)&&(e="pm"),a("#ticket_end_hour").val(c),a("#ticket_end_meridian").val(e),a("#ticket_start_minute").val(b.data.start_date.substring(14,
16)),a("#ticket_end_minute").val(b.data.end_date.substring(14,16)));a("tr.ticket_advanced_"+b.data.provider_class).remove();a("tr.ticket.bottom").before(b.data.advanced_fields);a("input:radio[name=ticket_provider]").filter("[value="+b.data.provider_class+"]").click();a("a#ticket_form_toggle").hide();a("#ticket_form").show()},"json").complete(function(){a("html, body").animate({scrollTop:a("#ticket_form_table").offset().top-50},500);k()})});ticketHeaderImage={uploader:function(){var a=wp.media({title:HeaderImageData.title,
multiple:!1,library:{type:"image"},button:{text:HeaderImageData.button}});a.on("close",function(){var d=a.state().get("selection").toJSON();d.length&&ticketHeaderImage.render(d[0])});a.open();return!1},render:function(b){a("#tribe_ticket_header_preview").html(ticketHeaderImage.imgHTML(b));a("#tribe_ticket_header_image_id").val(b.id);a("#tribe_ticket_header_remove").show()},imgHTML:function(a){var d='<img src="'+a.url+'" ',d=d+('width="'+a.width+'" '),d=d+('height="'+a.height+'" ');return d+"/>"}};
var l=a("#tribe_ticket_header_remove"),m=a("#tribe_ticket_header_preview");m.find("img").length&&l.show();l.live("click",function(b){b.preventDefault();m.html("");l.hide();a("#tribe_ticket_header_image_id").val("")});a("#tribe_ticket_header_preview img").length&&(f=a("#tribe_ticket_header_preview img"),f.removeAttr("width").removeAttr("height"),a("#tribetickets").width()<f.width()&&f.css("width","95%"))});
